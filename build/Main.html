<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>Main</title><script type="text/javascript" src="/home/south/.cabal/share/Elm-0.11/elm-runtime.js"></script><script type="text/javascript">Elm.Main = Elm.Main || {};
Elm.Main.make = function (_elm) {
   _elm.Main = _elm.Main || {};
   if (_elm.Main.values)
   return _elm.Main.values;
   var _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _E = _N.Error.make(_elm),
   _J = _N.JavaScript.make(_elm),
   $moduleName = "Main";
   var Basics = Elm.Basics.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Native = Native || {};
   Native.Ports = Elm.Native.Ports.make(_elm);
   var Prelude = Elm.Prelude.make(_elm);
   var Set = Elm.Set.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var String = Elm.String.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Time = Elm.Time.make(_elm);
   var _op = {};
   var showFloor = Basics.always(_U.chr(" "));
   var showPlayer = Basics.always(_U.chr("@"));
   var coordinates = _J.toList([{ctor: "_Tuple4"
                                ,_0: 0
                                ,_1: 0
                                ,_2: 0
                                ,_3: 0}
                               ,{ctor: "_Tuple4"
                                ,_0: 0
                                ,_1: 0
                                ,_2: 0
                                ,_3: 1}
                               ,{ctor: "_Tuple4"
                                ,_0: 0
                                ,_1: 0
                                ,_2: 1
                                ,_3: 0}
                               ,{ctor: "_Tuple4"
                                ,_0: 0
                                ,_1: 0
                                ,_2: 1
                                ,_3: 1}
                               ,{ctor: "_Tuple4"
                                ,_0: 0
                                ,_1: 1
                                ,_2: 0
                                ,_3: 0}
                               ,{ctor: "_Tuple4"
                                ,_0: 0
                                ,_1: 1
                                ,_2: 1
                                ,_3: 1}
                               ,{ctor: "_Tuple4"
                                ,_0: 0
                                ,_1: 1
                                ,_2: 1
                                ,_3: 0}
                               ,{ctor: "_Tuple4"
                                ,_0: 0
                                ,_1: 1
                                ,_2: 0
                                ,_3: 1}
                               ,{ctor: "_Tuple4"
                                ,_0: 1
                                ,_1: 0
                                ,_2: 0
                                ,_3: 0}
                               ,{ctor: "_Tuple4"
                                ,_0: 1
                                ,_1: 0
                                ,_2: 1
                                ,_3: 1}
                               ,{ctor: "_Tuple4"
                                ,_0: 1
                                ,_1: 0
                                ,_2: 1
                                ,_3: 0}
                               ,{ctor: "_Tuple4"
                                ,_0: 1
                                ,_1: 0
                                ,_2: 0
                                ,_3: 1}
                               ,{ctor: "_Tuple4"
                                ,_0: 1
                                ,_1: 1
                                ,_2: 0
                                ,_3: 0}
                               ,{ctor: "_Tuple4"
                                ,_0: 1
                                ,_1: 1
                                ,_2: 1
                                ,_3: 1}
                               ,{ctor: "_Tuple4"
                                ,_0: 1
                                ,_1: 1
                                ,_2: 1
                                ,_3: 0}
                               ,{ctor: "_Tuple4"
                                ,_0: 1
                                ,_1: 1
                                ,_2: 0
                                ,_3: 1}]);
   var lbind = Basics.flip(List.concatMap);
   var groupOn = F2(function (n,
   list) {
      return function () {
         switch (list.ctor)
         {case "[]":
            return _J.toList([]);}
         return {ctor: "::"
                ,_0: A2(List.take,n,list)
                ,_1: A2(groupOn,
                n,
                A2(List.drop,n,list))};
      }();
   });
   var unlines = function (xs) {
      return function () {
         switch (xs.ctor)
         {case "::":
            return A2(String.append,
              A2(String.append,xs._0,"\n"),
              unlines(xs._1));
            case "[]": return "";}
         _E.Case($moduleName,
         "between lines 112 and 114");
      }();
   };
   var mergeJusts = F2(function (xs,
   ys) {
      return function () {
         var _v4 = {ctor: "_Tuple2"
                   ,_0: xs
                   ,_1: ys};
         switch (_v4.ctor)
         {case "_Tuple2":
            switch (_v4._0.ctor)
              {case "::":
                 switch (_v4._0._0.ctor)
                   {case "Just":
                      switch (_v4._1.ctor)
                        {case "::": return {ctor: "::"
                                           ,_0: Maybe.Just(_v4._0._0._0)
                                           ,_1: A2(mergeJusts,
                                           _v4._0._1,
                                           _v4._1._1)};}
                        break;
                      case "Nothing":
                      switch (_v4._1.ctor)
                        {case "::":
                           switch (_v4._1._0.ctor)
                             {case "Just": return {ctor: "::"
                                                  ,_0: Maybe.Just(_v4._1._0._0)
                                                  ,_1: A2(mergeJusts,
                                                  _v4._0._1,
                                                  _v4._1._1)};
                                case "Nothing":
                                return {ctor: "::"
                                       ,_0: Maybe.Nothing
                                       ,_1: A2(mergeJusts,
                                       _v4._0._1,
                                       _v4._1._1)};}
                             break;}
                        break;}
                   break;}
              break;}
         return _J.toList([]);
      }();
   });
   var zipWith4 = F5(function (f,
   ws,
   xs,
   ys,
   zs) {
      return function () {
         var _v15 = {ctor: "_Tuple4"
                    ,_0: ws
                    ,_1: xs
                    ,_2: ys
                    ,_3: zs};
         switch (_v15.ctor)
         {case "_Tuple4":
            switch (_v15._0.ctor)
              {case "::":
                 switch (_v15._1.ctor)
                   {case "::":
                      switch (_v15._2.ctor)
                        {case "::":
                           switch (_v15._3.ctor)
                             {case "::": return {ctor: "::"
                                                ,_0: A4(f,
                                                _v15._0._0,
                                                _v15._1._0,
                                                _v15._2._0,
                                                _v15._3._0)
                                                ,_1: A5(zipWith4,
                                                f,
                                                _v15._0._1,
                                                _v15._1._1,
                                                _v15._2._1,
                                                _v15._3._1)};}
                             break;}
                        break;}
                   break;}
              break;}
         return _J.toList([]);
      }();
   });
   var merge4 = zipWith4(F4(function (x,
   y,
   z,
   w) {
      return function () {
         var cs = A2(List.filter,
         F2(function (x,y) {
            return !_U.eq(x,y);
         })(_U.chr(" ")),
         _J.toList([x,y,z,w]));
         return function () {
            switch (cs.ctor)
            {case "::": return cs._0;
               case "[]": return _U.chr(" ");}
            _E.Case($moduleName,
            "between lines 90 and 92");
         }();
      }();
   }));
   var merge4Justs = zipWith4(F4(function (x,
   y,
   z,
   w) {
      return function () {
         var cs = A2(List.filter,
         Maybe.isJust,
         _J.toList([x,y,z,w]));
         return function () {
            switch (cs.ctor)
            {case "::": return cs._0;
               case "[]":
               return Maybe.Nothing;}
            _E.Case($moduleName,
            "between lines 96 and 98");
         }();
      }();
   }));
   var merge = List.zipWith(F2(function (x,
   y) {
      return _U.eq(x,
      _U.chr(" ")) ? y : x;
   }));
   var mergeAll = function (xs) {
      return function () {
         switch (xs.ctor)
         {case "::": return A2(merge,
              xs._0,
              mergeAll(xs._1));
            case "[]":
            return _J.toList([]);}
         _E.Case($moduleName,
         "between lines 76 and 79");
      }();
   };
   var setSwitch = F2(function (b,
   s) {
      return _U.replace([["$switch"
                         ,b]],
      s);
   });
   var PlayerMove = function (a) {
      return {ctor: "PlayerMove"
             ,_0: a};
   };
   var SwitchPrism = F2(function (a,
   b) {
      return {ctor: "SwitchPrism"
             ,_0: a
             ,_1: b};
   });
   var SwitchReceptor = F2(function (a,
   b) {
      return {ctor: "SwitchReceptor"
             ,_0: a
             ,_1: b};
   });
   var SwitchLaser = F3(function (a,
   b,
   c) {
      return {ctor: "SwitchLaser"
             ,_0: a
             ,_1: b
             ,_2: c};
   });
   var Game = F3(function (a,b,c) {
      return {_: {}
             ,board: b
             ,plr: a
             ,won: c};
   });
   var Board = F5(function (a,
   b,
   c,
   d,
   e) {
      return {_: {}
             ,lasers: c
             ,minmax: e
             ,prisms: a
             ,receptors: b
             ,tiles: d};
   });
   var Switchable = F2(function (a,
   b) {
      return _U.insert("$switch",
      a,
      b);
   });
   var Positioned = F2(function (a,
   b) {
      return _U.insert("pos",a,b);
   });
   var Off = {ctor: "Off"};
   var On = {ctor: "On"};
   var showPrism = function (_v37) {
      return function () {
         return function () {
            var _v39 = _v37.$switch;
            switch (_v39.ctor)
            {case "Off": return _U.chr("*");
               case "On": return _U.chr("%");}
            _E.Case($moduleName,
            "between lines 220 and 222");
         }();
      }();
   };
   var showReceptor = function (_v40) {
      return function () {
         return function () {
            var _v42 = _v40.$switch;
            switch (_v42.ctor)
            {case "Off": return _U.chr("_");
               case "On": return _U.chr("$");}
            _E.Case($moduleName,
            "between lines 225 and 227");
         }();
      }();
   };
   var W = {ctor: "W"};
   var Z = {ctor: "Z"};
   var Y = {ctor: "Y"};
   var X = {ctor: "X"};
   var axisOrder = F2(function (a,
   b) {
      return function () {
         var _v43 = {ctor: "_Tuple2"
                    ,_0: a
                    ,_1: b};
         switch (_v43.ctor)
         {case "_Tuple2":
            switch (_v43._0.ctor)
              {case "W": return Basics.GT;
                 case "X": return Basics.LT;
                 case "Y": return _U.eq(_v43._1,
                   X) ? Basics.GT : Basics.LT;
                 case "Z": return _U.eq(_v43._1,
                   W) ? Basics.LT : Basics.GT;}
              break;}
         _E.Case($moduleName,
         "between lines 37 and 41");
      }();
   });
   var mapCoordinate = F3(function (a,
   f,
   _v46) {
      return function () {
         switch (_v46.ctor)
         {case "_Tuple4":
            return function () {
                 switch (a.ctor)
                 {case "W":
                    return {ctor: "_Tuple4"
                           ,_0: _v46._0
                           ,_1: _v46._1
                           ,_2: _v46._2
                           ,_3: f(_v46._3)};
                    case "X":
                    return {ctor: "_Tuple4"
                           ,_0: f(_v46._0)
                           ,_1: _v46._1
                           ,_2: _v46._2
                           ,_3: _v46._3};
                    case "Y":
                    return {ctor: "_Tuple4"
                           ,_0: _v46._0
                           ,_1: f(_v46._1)
                           ,_2: _v46._2
                           ,_3: _v46._3};
                    case "Z":
                    return {ctor: "_Tuple4"
                           ,_0: _v46._0
                           ,_1: _v46._1
                           ,_2: f(_v46._2)
                           ,_3: _v46._3};}
                 _E.Case($moduleName,
                 "between lines 47 and 51");
              }();}
         _E.Case($moduleName,
         "between lines 47 and 51");
      }();
   });
   var setCoordinate = F2(function (a,
   i) {
      return A2(mapCoordinate,
      a,
      Basics.always(i));
   });
   var mapPosCoordinate = F3(function (a,
   f,
   p) {
      return function () {
         var pos$ = p.pos;
         return _U.replace([["pos"
                            ,A3(mapCoordinate,a,f,pos$)]],
         p);
      }();
   });
   var setPosCoordinate = F2(function (a,
   i) {
      return A2(mapPosCoordinate,
      a,
      Basics.always(i));
   });
   var getCoordinate = F2(function (a,
   _v53) {
      return function () {
         switch (_v53.ctor)
         {case "_Tuple4":
            return function () {
                 switch (a.ctor)
                 {case "W": return _v53._3;
                    case "X": return _v53._0;
                    case "Y": return _v53._1;
                    case "Z": return _v53._2;}
                 _E.Case($moduleName,
                 "between lines 54 and 58");
              }();}
         _E.Case($moduleName,
         "between lines 54 and 58");
      }();
   });
   var getPosCoordinate = F2(function (a,
   _v60) {
      return function () {
         return A2(getCoordinate,
         a,
         _v60.pos);
      }();
   });
   var iterAxis = F4(function (axis,
   is,
   f,
   ps) {
      return function () {
         switch (is.ctor)
         {case "::": return function () {
                 var _v65 = A2(List.filter,
                 function (p) {
                    return _U.eq(A2(getPosCoordinate,
                    axis,
                    p),
                    is._0);
                 },
                 ps);
                 switch (_v65.ctor)
                 {case "::": return {ctor: "::"
                                    ,_0: {ctor: "_Tuple3"
                                         ,_0: axis
                                         ,_1: is._0
                                         ,_2: Maybe.Just(f(_v65._0))}
                                    ,_1: A4(iterAxis,
                                    axis,
                                    is._1,
                                    f,
                                    ps)};
                    case "[]": return {ctor: "::"
                                      ,_0: {ctor: "_Tuple3"
                                           ,_0: axis
                                           ,_1: is._0
                                           ,_2: Maybe.Nothing}
                                      ,_1: A4(iterAxis,
                                      axis,
                                      is._1,
                                      f,
                                      ps)};}
                 _E.Case($moduleName,
                 "between lines 129 and 132");
              }();
            case "[]":
            return _J.toList([]);}
         _E.Case($moduleName,
         "between lines 127 and 132");
      }();
   });
   var iterAxes = F4(function (_v68,
   is,
   f,
   ps) {
      return function () {
         switch (_v68.ctor)
         {case "_Tuple2":
            return function () {
                 switch (is.ctor)
                 {case "::": switch (is._0.ctor)
                      {case "_Tuple2":
                         return function () {
                              var _v77 = A2(List.filter,
                              function (p) {
                                 return _U.eq(A2(getPosCoordinate,
                                 _v68._0,
                                 p),
                                 is._0._0) && _U.eq(A2(getPosCoordinate,
                                 _v68._1,
                                 p),
                                 is._0._1);
                              },
                              ps);
                              switch (_v77.ctor)
                              {case "::": return {ctor: "::"
                                                 ,_0: Maybe.Just(f(_v77._0))
                                                 ,_1: A4(iterAxes,
                                                 {ctor: "_Tuple2"
                                                 ,_0: _v68._0
                                                 ,_1: _v68._1},
                                                 is._1,
                                                 f,
                                                 ps)};
                                 case "[]": return {ctor: "::"
                                                   ,_0: Maybe.Nothing
                                                   ,_1: A4(iterAxes,
                                                   {ctor: "_Tuple2"
                                                   ,_0: _v68._0
                                                   ,_1: _v68._1},
                                                   is._1,
                                                   f,
                                                   ps)};}
                              _E.Case($moduleName,
                              "between lines 136 and 139");
                           }();}
                      break;
                    case "[]":
                    return _J.toList([]);}
                 _E.Case($moduleName,
                 "between lines 134 and 139");
              }();}
         _E.Case($moduleName,
         "between lines 134 and 139");
      }();
   });
   var inSlice = F3(function (v,
   _v80,
   p) {
      return function () {
         switch (_v80.ctor)
         {case "_Tuple2":
            return _U.eq(A2(getCoordinate,
              _v80._0,
              v),
              A2(getPosCoordinate,
              _v80._0,
              p)) && _U.eq(A2(getCoordinate,
              _v80._1,
              v),
              A2(getPosCoordinate,
              _v80._1,
              p));}
         _E.Case($moduleName,
         "between lines 108 and 109");
      }();
   });
   var notAxes = function (_v84) {
      return function () {
         switch (_v84.ctor)
         {case "_Tuple2":
            return A2(List.filter,
              function (x) {
                 return !_U.eq(x,
                 _v84._0) && !_U.eq(x,_v84._1);
              },
              _J.toList([X,Y,Z,W]));}
         _E.Case($moduleName,
         "on line 117, column 18 to 59");
      }();
   };
   var testBoard = function () {
      var mm = {ctor: "_Tuple2"
               ,_0: 0
               ,_1: 1};
      var ts = _J.toList([]);
      var ls = _J.toList([{_: {}
                          ,$switch: Off
                          ,dir: X
                          ,pos: {ctor: "_Tuple4"
                                ,_0: 0
                                ,_1: 1
                                ,_2: 0
                                ,_3: 0}}]);
      var rs = _J.toList([{_: {}
                          ,$switch: Off
                          ,pos: {ctor: "_Tuple4"
                                ,_0: 1
                                ,_1: 1
                                ,_2: 0
                                ,_3: 0}}]);
      var ps = _J.toList([]);
      return A5(Board,ps,rs,ls,ts,mm);
   }();
   var planes = _J.toList([{ctor: "_Tuple2"
                           ,_0: X
                           ,_1: Y}
                          ,{ctor: "_Tuple2",_0: X,_1: Z}
                          ,{ctor: "_Tuple2",_0: X,_1: W}
                          ,{ctor: "_Tuple2",_0: Y,_1: Z}
                          ,{ctor: "_Tuple2",_0: Y,_1: W}
                          ,{ctor: "_Tuple2"
                           ,_0: Z
                           ,_1: W}]);
   var showLaser = function (_v88) {
      return function () {
         return function () {
            var _v90 = _v88.$switch;
            switch (_v90.ctor)
            {case "Off": return _U.chr("?");
               case "On": return function () {
                    var _v91 = _v88.dir;
                    switch (_v91.ctor)
                    {case "W": return _U.chr(";");
                       case "X": return _U.chr(":");
                       case "Y": return _U.chr("=");
                       case "Z": return _U.chr(".");}
                    _E.Case($moduleName,
                    "between lines 232 and 237");
                 }();}
            _E.Case($moduleName,
            "between lines 231 and 237");
         }();
      }();
   };
   var showSlice = F3(function (v,
   _v92,
   b) {
      return function () {
         switch (_v92.ctor)
         {case "_Tuple2":
            return function () {
                 var $ = b.minmax,
                 mini = $._0,
                 maxi = $._1;
                 var len = maxi - mini + 1;
                 var getAll = F2(function (f,
                 xs) {
                    return A4(iterAxes,
                    {ctor: "_Tuple2"
                    ,_0: _v92._0
                    ,_1: _v92._1},
                    A2(lbind,
                    _L.range(mini,maxi),
                    function (x) {
                       return A2(lbind,
                       _L.range(mini,maxi),
                       function (y) {
                          return _J.toList([{ctor: "_Tuple2"
                                            ,_0: y
                                            ,_1: x}]);
                       });
                    }),
                    f,
                    xs);
                 });
                 var $ = List.sortWith(axisOrder)(notAxes({ctor: "_Tuple2"
                                                          ,_0: _v92._0
                                                          ,_1: _v92._1}));
                 var a1$ = function () {
                    switch ($.ctor)
                    {case "::": switch ($._1.ctor)
                         {case "::":
                            switch ($._1._1.ctor)
                              {case "[]": return $._0;}
                              break;}
                         break;}
                    _E.Case($moduleName,
                    "on line 148, column 26 to 63");
                 }();
                 var a2$ = function () {
                    switch ($.ctor)
                    {case "::": switch ($._1.ctor)
                         {case "::":
                            switch ($._1._1.ctor)
                              {case "[]": return $._1._0;}
                              break;}
                         break;}
                    _E.Case($moduleName,
                    "on line 148, column 26 to 63");
                 }();
                 var fbP = function ($) {
                    return List.sortBy(function (_) {
                       return _.pos;
                    })(List.filter(A2(inSlice,
                    v,
                    {ctor: "_Tuple2"
                    ,_0: a1$
                    ,_1: a2$}))($));
                 };
                 var $ = {ctor: "_Tuple4"
                         ,_0: fbP(b.prisms)
                         ,_1: fbP(b.receptors)
                         ,_2: fbP(b.lasers)
                         ,_3: fbP(b.tiles)},
                 ps = $._0,
                 rs = $._1,
                 ls = $._2,
                 ts = $._3;
                 return A2(List.map,
                 Graphics.Element.flow(Graphics.Element.up),
                 _J.toList([List.map(function ($) {
                    return Text.text(Text.height(40)(Text.monospace(Text.toText(String.fromList($)))));
                 })(groupOn(len)(List.map(A2(Maybe.maybe,
                 _U.chr("·"),
                 Basics.id))(A2(mergeJusts,
                 A2(mergeJusts,
                 A2(mergeJusts,
                 A2(getAll,showLaser,ls),
                 A2(getAll,showReceptor,rs)),
                 A2(getAll,showPrism,ps)),
                 A2(getAll,showFloor,ts)))))]));
              }();}
         _E.Case($moduleName,
         "between lines 148 and 166");
      }();
   });
   var main = Graphics.Element.flow(Graphics.Element.down)(List.intersperse(A2(Graphics.Element.spacer,
   20,
   20))(A2(lbind,
   coordinates,
   function (x) {
      return A2(lbind,
      planes,
      function (p) {
         return A3(showSlice,
         x,
         p,
         testBoard);
      });
   })));
   var showAxis = function (a) {
      return function () {
         switch (a.ctor)
         {case "W": return _U.chr("W");
            case "X": return _U.chr("X");
            case "Y": return _U.chr("Y");
            case "Z": return _U.chr("Z");}
         _E.Case($moduleName,
         "between lines 243 and 247");
      }();
   };
   _elm.Main.values = {_op: _op
                      ,axisOrder: axisOrder
                      ,setSwitch: setSwitch
                      ,mapCoordinate: mapCoordinate
                      ,getCoordinate: getCoordinate
                      ,setCoordinate: setCoordinate
                      ,mapPosCoordinate: mapPosCoordinate
                      ,setPosCoordinate: setPosCoordinate
                      ,getPosCoordinate: getPosCoordinate
                      ,merge: merge
                      ,mergeAll: mergeAll
                      ,zipWith4: zipWith4
                      ,merge4: merge4
                      ,merge4Justs: merge4Justs
                      ,mergeJusts: mergeJusts
                      ,inSlice: inSlice
                      ,unlines: unlines
                      ,notAxes: notAxes
                      ,iterAxis: iterAxis
                      ,iterAxes: iterAxes
                      ,groupOn: groupOn
                      ,showSlice: showSlice
                      ,lbind: lbind
                      ,main: main
                      ,testBoard: testBoard
                      ,coordinates: coordinates
                      ,planes: planes
                      ,showPrism: showPrism
                      ,showReceptor: showReceptor
                      ,showLaser: showLaser
                      ,showPlayer: showPlayer
                      ,showAxis: showAxis
                      ,showFloor: showFloor
                      ,X: X
                      ,Y: Y
                      ,Z: Z
                      ,W: W
                      ,On: On
                      ,Off: Off
                      ,SwitchLaser: SwitchLaser
                      ,SwitchReceptor: SwitchReceptor
                      ,SwitchPrism: SwitchPrism
                      ,PlayerMove: PlayerMove
                      ,Positioned: Positioned
                      ,Switchable: Switchable
                      ,Board: Board
                      ,Game: Game};
   return _elm.Main.values;
};</script></head><body><script type="text/javascript">Elm.fullscreen(Elm.Main)</script><noscript></noscript></body></html>